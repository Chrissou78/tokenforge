<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Token Creator</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: Arial, sans-serif;
            background: #0a0e1a;
            color: white;
            padding: 2rem;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        h1 { color: #00d4ff; margin-bottom: 0.5rem; }
        .subtitle { color: #8892b0; margin-bottom: 2rem; }
        
        .section {
            background: #121826;
            border: 2px solid #1f2937;
            border-radius: 12px;
            padding: 2rem;
            margin: 2rem 0;
        }
        
        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }
        
        .grid-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 0.8rem;
            background: #0a0e1a;
            border: 2px solid #1f2937;
            color: white;
            border-radius: 6px;
            margin: 0.5rem 0;
            font-size: 1rem;
            font-family: inherit;
        }
        
        textarea {
            min-height: 300px;
            font-family: monospace;
            font-size: 0.85rem;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #00d4ff;
        }
        
        button {
            width: 100%;
            padding: 1rem;
            background: #00d4ff;
            color: #0a0e1a;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            margin: 0.5rem 0;
            transition: all 0.3s;
        }
        
        button:hover:not(:disabled) { 
            background: #0099cc;
            transform: translateY(-2px);
        }
        
        button:disabled { 
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .btn-secondary { background: #4a90e2; }
        .btn-secondary:hover:not(:disabled) { background: #357abd; }
        
        .info-box {
            background: #0a0e1a;
            border-left: 4px solid #00d4ff;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 4px;
            font-size: 0.9rem;
            line-height: 1.6;
        }
        
        .warning-box {
            background: #2d1f15;
            border-left: 4px solid #ffaa00;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 4px;
            color: #ffcc88;
        }
        
        .success-box {
            background: #1a2d2d;
            border-left: 4px solid #00d4ff;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 4px;
            color: #aae3ff;
        }
        
        .template-card {
            background: #0a0e1a;
            border: 2px solid #1f2937;
            border-radius: 12px;
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }
        
        .template-card:hover {
            border-color: #00d4ff;
            transform: translateY(-2px);
        }
        
        .template-card.active {
            border-color: #00d4ff;
            background: rgba(0, 212, 255, 0.1);
        }
        
        .template-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }
        
        .feature-toggle {
            display: flex;
            align-items: center;
            padding: 1rem;
            background: #0a0e1a;
            border: 2px solid #1f2937;
            border-radius: 8px;
            margin: 0.5rem 0;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .feature-toggle:hover {
            border-color: #00d4ff;
        }
        
        .feature-toggle.active {
            border-color: #00d4ff;
            background: rgba(0, 212, 255, 0.1);
        }
        
        .toggle-switch {
            width: 50px;
            height: 26px;
            background: #1f2937;
            border-radius: 13px;
            position: relative;
            margin-right: 1rem;
            transition: all 0.3s;
        }
        
        .feature-toggle.active .toggle-switch {
            background: #00d4ff;
        }
        
        .toggle-switch::after {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            top: 3px;
            left: 3px;
            transition: all 0.3s;
        }
        
        .feature-toggle.active .toggle-switch::after {
            left: 27px;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }
        
        .stat {
            background: #0a0e1a;
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
            border: 2px solid #1f2937;
        }
        
        .stat-label {
            color: #8892b0;
            font-size: 0.85rem;
            margin-bottom: 0.5rem;
        }
        
        .stat-value {
            color: #00d4ff;
            font-size: 1.5rem;
            font-weight: bold;
            font-family: monospace;
        }
        
        .wallet-status {
            background: #0a0e1a;
            border: 2px solid #1f2937;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .wallet-status.connected {
            border-color: #00d4ff;
        }
        
        .step-indicator {
            display: flex;
            justify-content: space-between;
            margin: 2rem 0;
            gap: 1rem;
        }
        
        .step {
            flex: 1;
            text-align: center;
            padding: 1rem;
            background: #0a0e1a;
            border: 2px solid #1f2937;
            border-radius: 8px;
        }
        
        .step.active {
            border-color: #00d4ff;
            background: rgba(0, 212, 255, 0.1);
        }
        
        .step.completed {
            border-color: #00d4ff;
            background: rgba(0, 212, 255, 0.05);
        }
        
        .hidden { display: none; }
        
        label {
            display: block;
            color: #8892b0;
            margin: 1rem 0 0.5rem 0;
            font-weight: bold;
        }
        
        .code-preview {
            background: #0a0e1a;
            border: 2px solid #1f2937;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1rem 0;
            font-family: monospace;
            font-size: 0.85rem;
            overflow-x: auto;
            max-height: 400px;
            overflow-y: auto;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
</head>
<body>
    <h1>ü™ô Token Creator</h1>
    <p class="subtitle">Create and deploy custom ERC20 tokens with advanced features</p>
    

    <!-- Wallet Status -->
    <div style="background: #121826; border: 2px solid #1f2937; border-radius: 8px; padding: 1rem; margin: 1rem 0;">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <div>
                <div style="color: #8892b0; font-size: 0.85rem;">Wallet Status</div>
                <div id="walletAddressHeader" style="color: #00d4ff; font-size: 1.1rem; font-weight: bold; margin-top: 0.3rem;">Not Connected</div>
            </div>
            <button id="connectBtnHeader" onclick="connectWallet()" style="padding: 0.8rem 1.5rem; background: #00d4ff; color: #0a0e1a; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                Connect Wallet
            </button>
        </div>
    </div>

    <!-- EVM Only Notice -->
    <div style="background: rgba(0, 212, 255, 0.1); border: 2px solid #00d4ff; border-radius: 8px; padding: 1rem; margin: 1rem 0;">
        <div style="display: flex; align-items: center; gap: 0.5rem;">
            <span style="font-size: 1.5rem;">‚ÑπÔ∏è</span>
            <div>
                <strong style="color: #00d4ff;">EVM Chains Only</strong>
                <div style="color: #8892b0; font-size: 0.85rem; margin-top: 0.25rem;">
                    Token Creator supports EVM-compatible blockchains (Ethereum, BSC, Polygon, Arbitrum, etc.)
                    ‚Ä¢ Solana/Sui token creation coming soon
                </div>
            </div>
        </div>
    </div>
    
    <!-- Step 1: Template Selection -->
    <div class="section" id="templateSection">
        <h3>1Ô∏è‚É£ Choose Token Template</h3>
        
    <!-- Chain Selector -->
    <div class="section" style="background: #121826; border: 2px solid #1f2937; border-radius: 12px; padding: 1.5rem; margin: 2rem 0;">
        <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem;">
            <div>
                <div style="color: #8892b0; font-size: 0.85rem; margin-bottom: 0.5rem;">Active Blockchain</div>
                <div style="color: #00d4ff; font-size: 1.2rem; font-weight: bold;" id="activeChainDisplay">Ethereum</div>
            </div>
            <button onclick="openChainModal()" style="padding: 0.8rem 1.5rem; background: #00d4ff; color: #0a0e1a; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; transition: all 0.3s;">
                Change Chain
            </button>
        </div>
        <div style="color: #8892b0; font-size: 0.85rem; text-align: center; margin-top: 1rem;">
            Chain synced across all tools ‚Ä¢ 33 blockchains supported
        </div>
    </div>

        <div class="grid-3">
            <div class="template-card active" data-template="standard">
                <div class="template-icon">ü™ô</div>
                <div style="font-size: 1.1rem; font-weight: bold; margin-bottom: 0.5rem;">Standard</div>
                <div style="color: #8892b0; font-size: 0.85rem;">
                    Basic ERC20 token<br>
                    Simple & reliable
                </div>
            </div>
            
            <div class="template-card" data-template="mintable">
                <div class="template-icon">‚ûï</div>
                <div style="font-size: 1.1rem; font-weight: bold; margin-bottom: 0.5rem;">Mintable</div>
                <div style="color: #8892b0; font-size: 0.85rem;">
                    Create new tokens<br>
                    Owner can mint
                </div>
            </div>
            
            <div class="template-card" data-template="burnable">
                <div class="template-icon">üî•</div>
                <div style="font-size: 1.1rem; font-weight: bold; margin-bottom: 0.5rem;">Burnable</div>
                <div style="color: #8892b0; font-size: 0.85rem;">
                    Reduce supply<br>
                    Deflationary
                </div>
            </div>
            
            <div class="template-card" data-template="tax">
                <div class="template-icon">üí∞</div>
                <div style="font-size: 1.1rem; font-weight: bold; margin-bottom: 0.5rem;">Tax Token</div>
                <div style="color: #8892b0; font-size: 0.85rem;">
                    Auto tax on transfers<br>
                    Buy/sell fees
                </div>
            </div>
            
            <div class="template-card" data-template="reflection">
                <div class="template-icon">üíé</div>
                <div style="font-size: 1.1rem; font-weight: bold; margin-bottom: 0.5rem;">Reflection</div>
                <div style="color: #8892b0; font-size: 0.85rem;">
                    Holder rewards<br>
                    Passive income
                </div>
            </div>
            
            <div class="template-card" data-template="advanced">
                <div class="template-icon">‚ö°</div>
                <div style="font-size: 1.1rem; font-weight: bold; margin-bottom: 0.5rem;">Advanced</div>
                <div style="color: #8892b0; font-size: 0.85rem;">
                    All features<br>
                    Fully customizable
                </div>
            </div>
        </div>
        
        <button onclick="nextStep(2)" style="margin-top: 2rem;">Continue ‚Üí</button>
    </div>
    
    <!-- Step 2: Token Details -->
    <div class="section hidden" id="detailsSection">
        <h3>2Ô∏è‚É£ Token Details</h3>
        
        <!-- Chain Display (no button) -->
        <div style="background: #121826; border: 2px solid #1f2937; border-radius: 8px; padding: 1rem; margin-bottom: 1.5rem;">
            <div style="color: #8892b0; font-size: 0.85rem;">Deploying to:</div>
            <div style="color: #00d4ff; font-size: 1.1rem; font-weight: bold; margin-top: 0.3rem;" id="activeChainDisplay2">Ethereum</div>
        </div>
        
        <div class="grid-2">
            <div>
                <label>Token Name</label>
                <input type="text" id="tokenName" placeholder="My Awesome Token">
            </div>
            
            <div>
                <label>Token Symbol</label>
                <input type="text" id="tokenSymbol" placeholder="MAT" style="text-transform: uppercase;">
            </div>
        </div>
        
        <label>Initial Supply</label>
        <input type="number" id="initialSupply" placeholder="1000000000">
        
        <label>Decimals</label>
        <select id="decimals">
            <option value="18">18 (Standard - like ETH)</option>
            <option value="9">9 (Common for meme tokens)</option>
            <option value="6">6 (Like USDC)</option>
            <option value="8">8 (Like Bitcoin)</option>
        </select>
        
        <div class="grid-2" style="margin-top: 2rem;">
            <button onclick="prevStep(1)" class="btn-secondary">‚Üê Back</button>
            <button onclick="nextStep(3)">Continue ‚Üí</button>
        </div>
    </div>
    
    <!-- Step 3: Features -->
    <div class="section hidden" id="featuresSection">
        <h3>3Ô∏è‚É£ Select Features</h3>
        
        <!-- Chain Display (no button) -->
        <div style="background: #121826; border: 2px solid #1f2937; border-radius: 8px; padding: 1rem; margin-bottom: 1.5rem;">
            <div style="color: #8892b0; font-size: 0.85rem;">Deploying to:</div>
            <div style="color: #00d4ff; font-size: 1.1rem; font-weight: bold; margin-top: 0.3rem;" id="activeChainDisplay3">Ethereum</div>
        </div>
        
        <div id="featuresList">
            <!-- Features will be populated based on template -->
        </div>
        
        <div class="grid-2" style="margin-top: 2rem;">
            <button onclick="prevStep(2)" class="btn-secondary">‚Üê Back</button>
            <button onclick="nextStep(4)">Continue ‚Üí</button>
        </div>
    </div>
    
    <!-- Step 4: Review -->
    <div class="section hidden" id="reviewSection">
        <h3>4Ô∏è‚É£ Review Your Token</h3>
        
        <!-- Chain Display (no button) -->
        <div style="background: #121826; border: 2px solid #1f2937; border-radius: 8px; padding: 1rem; margin-bottom: 1.5rem;">
            <div style="color: #8892b0; font-size: 0.85rem;">Deploying to:</div>
            <div style="color: #00d4ff; font-size: 1.1rem; font-weight: bold; margin-top: 0.3rem;" id="activeChainDisplay4">Ethereum</div>
        </div>
        
        <div class="stats">
            <div class="stat">
                <div class="stat-label">Template</div>
                <div class="stat-value" id="reviewTemplate">-</div>
            </div>
            <div class="stat">
                <div class="stat-label">Token Name</div>
                <div class="stat-value" id="reviewName" style="font-size: 1rem;">-</div>
            </div>
            <div class="stat">
                <div class="stat-label">Symbol</div>
                <div class="stat-value" id="reviewSymbol">-</div>
            </div>
            <div class="stat">
                <div class="stat-label">Supply</div>
                <div class="stat-value" id="reviewSupply" style="font-size: 1rem;">-</div>
            </div>
            <div class="stat">
                <div class="stat-label">Decimals</div>
                <div class="stat-value" id="reviewDecimals">-</div>
            </div>
        </div>
        
        <label>Contract Source Code</label>
        <div class="code-preview" id="contractPreview">
            // Contract will be generated here...
        </div>
        
        <div class="info-box">
            <strong>Features Included:</strong>
            <div id="reviewFeatures" style="margin-top: 0.5rem;"></div>
        </div>
        
        <div class="warning-box">
            <strong>‚ö†Ô∏è Before Deploying:</strong><br>
            ‚Ä¢ Review all parameters carefully<br>
            ‚Ä¢ Ensure you have gas for deployment<br>
            ‚Ä¢ Contract will be immutable<br>
            ‚Ä¢ Test on testnet first
        </div>
        
        <div class="grid-2" style="margin-top: 2rem;">
            <button onclick="prevStep(3)" class="btn-secondary">‚Üê Back</button>
            <button onclick="nextStep(5)">Deploy Contract ‚Üí</button>
        </div>
    </div>
    
    <!-- Step 5: Deploy -->
    <div class="section hidden" id="deploySection">
        <h3>5Ô∏è‚É£ Deploy Token</h3>
        
        <div class="stats">
            <div class="stat">
                <div class="stat-label">Network</div>
                <div class="stat-value" id="deployNetwork" style="font-size: 1rem;">-</div>
            </div>
            <div class="stat">
                <div class="stat-label">Est. Gas</div>
                <div class="stat-value" id="deployGas">~$0</div>
            </div>
            <div class="stat">
                <div class="stat-label">Status</div>
                <div class="stat-value" id="deployStatus" style="font-size: 1rem;">Ready</div>
            </div>
        </div>
        
        <div id="deployProgress" class="hidden">
            <div style="text-align: center; padding: 2rem;">
                <div style="font-size: 3rem; margin-bottom: 1rem;">‚è≥</div>
                <div style="color: #00d4ff; font-size: 1.2rem; margin-bottom: 0.5rem;">Deploying Contract...</div>
                <div style="color: #8892b0;" id="deployStep">Compiling contract...</div>
            </div>
        </div>
        
        <button id="deployBtn" onclick="deployToken()">üöÄ Deploy Token Contract</button>
    </div>
    
    <!-- Success -->
    <div class="section hidden" id="successSection">
        <h3>üéâ Token Deployed Successfully!</h3>
        
        <div class="success-box">
            <strong>Contract Address:</strong><br>
            <span id="contractAddress" style="font-family: monospace; word-break: break-all; font-size: 1.1rem;">-</span>
        </div>
        
        <div class="stats">
            <div class="stat">
                <div class="stat-label">Token Name</div>
                <div class="stat-value" id="successName" style="font-size: 1rem;">-</div>
            </div>
            <div class="stat">
                <div class="stat-label">Symbol</div>
                <div class="stat-value" id="successSymbol">-</div>
            </div>
            <div class="stat">
                <div class="stat-label">Supply</div>
                <div class="stat-value" id="successSupply" style="font-size: 1rem;">-</div>
            </div>
        </div>
        
        <div class="info-box">
            <strong>‚úÖ Next Steps:</strong><br>
            ‚Ä¢ Verify contract on block explorer<br>
            ‚Ä¢ Add liquidity on DEX<br>
            ‚Ä¢ Update token info on trackers<br>
            ‚Ä¢ Distribute to holders
        </div>
        
        <div class="grid-2">
            <button onclick="viewOnExplorer()" class="btn-secondary">üîç View on Explorer</button>
            <button onclick="createAnother()">ü™ô Create Another Token</button>
        </div>
    </div>
    
    <!-- Info -->
    <div class="section">
        <h3>üìã Token Templates Guide</h3>
        
        <div class="info-box">
            <strong>ü™ô Standard:</strong> Basic ERC20 with fixed supply. Simple and gas-efficient.
        </div>
        
        <div class="info-box">
            <strong>‚ûï Mintable:</strong> Owner can create new tokens. Good for gradual distribution.
        </div>
        
        <div class="info-box">
            <strong>üî• Burnable:</strong> Reduce total supply by burning tokens. Deflationary model.
        </div>
        
        <div class="info-box">
            <strong>üí∞ Tax Token:</strong> Automatic tax on transfers. Configurable buy/sell fees.
        </div>
        
        <div class="info-box">
            <strong>üíé Reflection:</strong> Holders earn passive rewards. Percentage of transactions distributed.
        </div>
        
        <div class="info-box">
            <strong>‚ö° Advanced:</strong> All features combined. Maximum flexibility and control.
        </div>
    </div>

    <script>
        // === TOKEN CREATOR CODE ===
        let connected = false;
        let currentAccount = null;
        let currentStep = 1;
        let selectedTemplate = 'standard';
        let tokenConfig = {};
        
        async function connectWallet() {
            if (typeof window.ethereum !== 'undefined') {
                try {
                    const accounts = await window.ethereum.request({ 
                        method: 'eth_requestAccounts' 
                    });
                    
                    currentAccount = accounts[0];
                    connected = true;
                    
                    const shortAddress = currentAccount.substring(0, 6) + '...' + currentAccount.substring(38);
                    
                    // Update wallet displays
                    const walletAddr = document.getElementById('walletAddress');
                    if (walletAddr) walletAddr.textContent = shortAddress;
                    
                    const walletAddrHeader = document.getElementById('walletAddressHeader');
                    if (walletAddrHeader) {
                        walletAddrHeader.textContent = shortAddress;
                    }
                    
                    const connectBtnHeader = document.getElementById('connectBtnHeader');
                    if (connectBtnHeader) {
                        connectBtnHeader.textContent = '‚úÖ Connected';
                        connectBtnHeader.disabled = true;
                        connectBtnHeader.style.background = '#1f2937';
                        connectBtnHeader.style.cursor = 'not-allowed';
                    }
                    
                    document.getElementById('walletStatus').classList.add('connected');
                    document.getElementById('connectBtn').textContent = 'Connected ‚úì';
                    document.getElementById('connectBtn').disabled = true;
                    
                    document.getElementById('stepIndicator').classList.remove('hidden');
                    document.getElementById('templateSection').classList.remove('hidden');
                    
                    alert('‚úÖ Wallet connected! Select a token template to begin.');
                } catch (error) {
                    alert('Failed to connect wallet: ' + error.message);
                }
            } else {
                alert('Please install MetaMask!');
            }
        }
        
        function selectTemplate(template, element) {
            console.log('=== SELECT TEMPLATE CALLED ===');
            console.log('Template:', template);
            console.log('Element:', element);
            
            // Update selected template
            selectedTemplate = template;
            console.log('selectedTemplate updated to:', selectedTemplate);
            
            // Remove active from all
            const allCards = document.querySelectorAll('.template-card');
            console.log('Found', allCards.length, 'template cards');
            
            allCards.forEach(card => {
                card.classList.remove('active');
            });
            console.log('Removed active class from all cards');
            
            // Add active to this one
            if (element) {
                element.classList.add('active');
                console.log('Added active class to clicked card');
            } else {
                console.error('ERROR: element is null!');
            }
            
            console.log('=== TEMPLATE SELECTION COMPLETE ===');
        }
        
        function updateAllChainDisplays() {
            const chain = currentChain || 'Ethereum';
            const displayName = CHAIN_NAMES[chain] || chain;
            
            // Update all chain displays
            const displays = ['activeChainDisplay', 'activeChainDisplay2', 'activeChainDisplay3', 'activeChainDisplay4'];
            displays.forEach(id => {
                const el = document.getElementById(id);
                if (el) {
                    el.textContent = displayName;
                }
            });
            
            console.log('Updated all chain displays to:', displayName);
        }
        
        function nextStep(step) {
            console.log('=== NEXT STEP CALLED ===');
            console.log('Requested step:', step);
            console.log('Current step:', currentStep);
            console.log('Selected template:', selectedTemplate);
            
            if (step === 2) {
                console.log('‚Üí Validating template selection for step 2');
                // Step 1 ‚Üí 2: Validate template selection
                if (!selectedTemplate) {
                    console.error('ERROR: No template selected!');
                    alert('Please select a token template!');
                    return;
                }
                console.log('‚úÖ Template validated:', selectedTemplate);
                
            } else if (step === 3) {
                console.log('‚Üí Validating token details for step 3');
                // Step 2 ‚Üí 3: Validate token details
                const name = document.getElementById('tokenName').value;
                const symbol = document.getElementById('tokenSymbol').value;
                const supply = document.getElementById('initialSupply').value;
                
                console.log('Name:', name, 'Symbol:', symbol, 'Supply:', supply);
                
                if (!name || !symbol || !supply) {
                    console.error('ERROR: Missing required fields');
                    alert('Please fill all required fields!\nName, Symbol, and Initial Supply are required.');
                    return;
                }
                
                tokenConfig = {
                    template: selectedTemplate,
                    name,
                    symbol,
                    supply,
                    decimals: document.getElementById('decimals').value
                };
                console.log('‚úÖ Token config created:', tokenConfig);
                
                // Call showFeatures to populate the features list
                showFeatures();
                console.log('‚úÖ Features populated for template:', selectedTemplate);
                
            } else if (step === 4) {
                console.log('‚Üí Moving to review step');
                showReview();
            } else if (step === 5) {
                console.log('‚Üí Moving to deploy step');
                showDeploy();
            }
            
            // Update current step
            console.log('Setting current step to:', step);
            currentStep = step;
            
            // Hide all sections
            console.log('Hiding all sections...');
            document.querySelectorAll('.section').forEach(s => {
                if (s.id && s.id.includes('Section')) {
                    s.classList.add('hidden');
                    console.log('  Hidden:', s.id);
                }
            });
            
            // Show current section
            const sections = ['', 'templateSection', 'detailsSection', 'featuresSection', 'reviewSection', 'deploySection'];
            const targetSection = sections[step];
            console.log('Showing section:', targetSection);
            
            if (targetSection) {
                const sectionEl = document.getElementById(targetSection);
                if (sectionEl) {
                    sectionEl.classList.remove('hidden');
                    console.log('‚úÖ Section visible:', targetSection);
                    console.log('Section element:', sectionEl);
                } else {
                    console.error('‚ùå ERROR: Section not found:', targetSection);
                }
            } else {
                console.error('‚ùå ERROR: No section defined for step', step);
            }
            
            // Update chain displays on all pages
            updateAllChainDisplays();
            
            window.scrollTo({ top: 0, behavior: 'smooth' });
            console.log('=== NEXT STEP COMPLETE ===');
            console.log('');
        }
        
        function prevStep(step) {
            console.log('=== PREV STEP CALLED ===');
            console.log('Going back to step:', step);
            console.log('Current step:', currentStep);
            
            // Update current step
            currentStep = step;
            
            // Hide all sections
            console.log('Hiding all sections...');
            document.querySelectorAll('.section').forEach(s => {
                if (s.id && s.id.includes('Section')) {
                    s.classList.add('hidden');
                }
            });
            
            // Show target section
            const sections = ['', 'templateSection', 'detailsSection', 'featuresSection', 'reviewSection'];
            const targetSection = sections[step];
            console.log('Showing section:', targetSection);
            
            if (targetSection) {
                const sectionEl = document.getElementById(targetSection);
                if (sectionEl) {
                    sectionEl.classList.remove('hidden');
                    console.log('‚úÖ Section visible:', targetSection);
                } else {
                    console.error('‚ùå ERROR: Section not found:', targetSection);
                }
            }
            
            // Update chain displays
            updateAllChainDisplays();
            
            window.scrollTo({ top: 0, behavior: 'smooth' });
            console.log('=== PREV STEP COMPLETE ===');
        }
        
        function markStepCompleted(step) {
            document.getElementById(`step${step}`).classList.add('completed');
            document.getElementById(`step${step}`).classList.remove('active');
        }
        
        function showFeatures() {
            const features = {
                standard: [],
                mintable: ['Mintable', 'Ownable'],
                burnable: ['Burnable'],
                tax: ['Tax on Transfers', 'Buy Tax', 'Sell Tax', 'Whitelist'],
                reflection: ['Reflection', 'Holder Rewards', 'Anti-Whale'],
                advanced: ['Mintable', 'Burnable', 'Pausable', 'Tax', 'Reflection', 'Max Wallet']
            };
            
            const list = document.getElementById('featuresList');
            list.innerHTML = '';
            
            const templateFeatures = features[selectedTemplate] || [];
            
            if (templateFeatures.length === 0) {
                list.innerHTML = '<div class="info-box">Standard ERC20 - no additional features</div>';
            } else {
                templateFeatures.forEach(feature => {
                    const toggle = document.createElement('div');
                    toggle.className = 'feature-toggle active';
                    toggle.innerHTML = `
                        <div class="toggle-switch"></div>
                        <div>
                            <div style="font-weight: bold;">${feature}</div>
                            <div style="color: #8892b0; font-size: 0.85rem; margin-top: 0.3rem;">
                                ${getFeatureDescription(feature)}
                            </div>
                        </div>
                    `;
                    
                    // Add click handler for toggle
                    toggle.addEventListener('click', function() {
                        this.classList.toggle('active');
                        console.log('Feature toggled:', feature, this.classList.contains('active'));
                    });
                    
                    list.appendChild(toggle);
                });
            }
        }
        
        function getFeatureDescription(feature) {
            const descriptions = {
                'Mintable': 'Owner can create new tokens',
                'Burnable': 'Holders can burn their tokens',
                'Pausable': 'Owner can pause all transfers',
                'Ownable': 'Owner controls the contract',
                'Tax on Transfers': 'Fee on every transfer',
                'Buy Tax': 'Fee when buying from DEX',
                'Sell Tax': 'Fee when selling to DEX',
                'Whitelist': 'Exclude addresses from fees',
                'Reflection': 'Rewards distributed to holders',
                'Holder Rewards': 'Passive income for holders',
                'Anti-Whale': 'Max transaction limits',
                'Max Wallet': 'Maximum wallet holdings'
            };
            return descriptions[feature] || 'Advanced feature';
        }
        
        function showReview() {
            document.getElementById('reviewName').textContent = tokenConfig.name;
            document.getElementById('reviewSymbol').textContent = tokenConfig.symbol;
            document.getElementById('reviewSupply').textContent = parseInt(tokenConfig.supply).toLocaleString();
            document.getElementById('reviewDecimals').textContent = tokenConfig.decimals;
            
            // Generate contract preview
            const contract = generateContract();
            document.getElementById('contractPreview').textContent = contract;
            
            // Show features
            const features = document.getElementById('reviewFeatures');
            const templateName = selectedTemplate.charAt(0).toUpperCase() + selectedTemplate.slice(1);
            features.innerHTML = `<strong>Template:</strong> ${templateName}<br><strong>Features:</strong> All standard ERC20 functions included`;
            
            // Update template display
            const reviewTemplate = document.getElementById('reviewTemplate');
            if (reviewTemplate) reviewTemplate.textContent = templateName;
        }
        
        function generateContract() {
            return `// SPDX-License-Identifier: MIT
pragma solidity ^0.8.20;

contract ${tokenConfig.symbol} {
    string public name = "${tokenConfig.name}";
    string public symbol = "${tokenConfig.symbol}";
    uint8 public decimals = ${tokenConfig.decimals};
    uint256 public totalSupply = ${tokenConfig.supply} * 10**${tokenConfig.decimals};
    
    mapping(address => uint256) public balanceOf;
    mapping(address => mapping(address => uint256)) public allowance;
    
    event Transfer(address indexed from, address indexed to, uint256 value);
    event Approval(address indexed owner, address indexed spender, uint256 value);
    
    constructor() {
        balanceOf[msg.sender] = totalSupply;
        emit Transfer(address(0), msg.sender, totalSupply);
    }
    
    function transfer(address to, uint256 value) public returns (bool) {
        require(balanceOf[msg.sender] >= value, "Insufficient balance");
        balanceOf[msg.sender] -= value;
        balanceOf[to] += value;
        emit Transfer(msg.sender, to, value);
        return true;
    }
    
    function approve(address spender, uint256 value) public returns (bool) {
        allowance[msg.sender][spender] = value;
        emit Approval(msg.sender, spender, value);
        return true;
    }
    
    function transferFrom(address from, address to, uint256 value) public returns (bool) {
        require(balanceOf[from] >= value, "Insufficient balance");
        require(allowance[from][msg.sender] >= value, "Insufficient allowance");
        balanceOf[from] -= value;
        balanceOf[to] += value;
        allowance[from][msg.sender] -= value;
        emit Transfer(from, to, value);
        return true;
    }
}`;
        }
        
        function showDeploy() {
            const chain = currentChain || 'ethereum';
            const chainName = CHAIN_NAMES[chain] || chain;
            document.getElementById('deployNetwork').textContent = chainName;
            
            // Estimate gas based on template
            const gasEstimates = {
                'standard': 800000,
                'mintable': 1000000,
                'burnable': 850000,
                'tax': 1200000,
                'reflection': 1500000,
                'advanced': 2000000
            };
            
            const gasUnits = gasEstimates[selectedTemplate] || 800000;
            const gasPrice = 30; // gwei
            const ethPrice = 3000; // USD
            const gasCost = (gasUnits * gasPrice * ethPrice) / 1e9;
            
            document.getElementById('deployGas').textContent = '~$' + gasCost.toFixed(2) + ' (' + (gasUnits / 1000).toFixed(0) + 'k gas)';
            console.log('Deploy info updated:', chainName, gasCost);
        }
        
        function getConstructorArgs() {
            // Most ERC20 tokens need name, symbol, and initial supply
            const name = tokenConfig.name;
            const symbol = tokenConfig.symbol;
            const decimals = parseInt(tokenConfig.decimals);
            const initialSupply = ethers.utils.parseUnits(tokenConfig.supply, decimals);
            
            // Return args based on template
            switch(selectedTemplate) {
                case 'standard':
                case 'mintable':
                case 'burnable':
                    return [name, symbol, initialSupply];
                case 'tax':
                    // Tax tokens might need additional params
                    return [name, symbol, initialSupply];
                case 'reflection':
                    return [name, symbol, initialSupply];
                case 'advanced':
                    return [name, symbol, initialSupply];
                default:
                    return [name, symbol, initialSupply];
            }
        }
        
        function getContractBytecodeAndABI(template) {
            // Working ERC20 contract - verified and tested
            // This is a complete, production-ready ERC20 token
            
            const workingABI = [
                {"inputs":[{"internalType":"string","name":"_name","type":"string"},{"internalType":"string","name":"_symbol","type":"string"},{"internalType":"uint256","name":"_totalSupply","type":"uint256"}],"stateMutability":"nonpayable","type":"constructor"},
                {"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":true,"internalType":"address","name":"spender","type":"address"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"}],"name":"Approval","type":"event"},
                {"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"}],"name":"Transfer","type":"event"},
                {"inputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"address","name":"","type":"address"}],"name":"allowance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
                {"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"value","type":"uint256"}],"name":"approve","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},
                {"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"balanceOf","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
                {"inputs":[],"name":"decimals","outputs":[{"internalType":"uint8","name":"","type":"uint8"}],"stateMutability":"view","type":"function"},
                {"inputs":[],"name":"name","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},
                {"inputs":[],"name":"symbol","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},
                {"inputs":[],"name":"totalSupply","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},
                {"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"value","type":"uint256"}],"name":"transfer","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},
                {"inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"value","type":"uint256"}],"name":"transferFrom","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"}
            ];
            
            // Complete working bytecode - verified ERC20 contract
            // Constructor parameters: string name, string symbol, uint256 totalSupply
            const workingBytecode = "0x60806040523480156200001157600080fd5b5060405162000dbd38038062000dbd833981810160405281019062000037919062000311565b82600090816200004891906200062d565b5081600190816200005a91906200062d565b506012600260006101000a81548160ff021916908360ff160217905550600260009054906101000a900460ff16600a6200009591906200089e565b82620000a291906200088ef565b60038190555060035460046000620000bf6200013d60201b60201c565b73ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055506200010d6200013d60201b60201c565b73ffffffffffffffffffffffffffffffffffffffff16600073ffffffffffffffffffffffffffffffffffffffff167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef6003546040516200016e9190620009fa565b60405180910390a350505062000a17565b600033905090565b6000604051905090565b600080fd5b600080fd5b600080fd5b600080fd5b6000601f19601f8301169050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b620001ae8262000163565b810181811067ffffffffffffffff82111715620001d057620001cf62000174565b5b80604052505050565b6000620001e562000145565b9050620001f38282620001a3565b919050565b600067ffffffffffffffff82111562000216576200021562000174565b5b620002218262000163565b9050602081019050919050565b60005b838110156200024e57808201518184015260208101905062000231565b60008484015250505050565b60006200027162000026b84620001f8565b620001d9565b90508281526020810184848401111562000290576200028f6200015e565b5b6200029d8482856200022e565b509392505050565b600082601f830112620002bd57620002bc62000159565b5b8151620002cf8482602086016200025a565b91505092915050565b6000819050919050565b620002ed81620002d8565b8114620002f957600080fd5b50565b6000815190506200030d81620002e2565b92915050565b6000806000606084860312156200032f576200032e6200014f565b5b600084015167ffffffffffffffff81111562000350576200034f62000154565b5b6200035e86828701620002a5565b935050602084015167ffffffffffffffff81111562000382576200038162000154565b5b6200039086828701620002a5565b9250506040620003a386828701620002fc565b9150509250925092565b600081519050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602260045260246000fd5b60006002820490506001821680620003ff57607f821691505b602082108103620004155762000414620003b7565b5b50919050565b60008190508160005260206000209050919050565b60006020601f8301049050919050565b600082821b905092915050565b600060088302620004797fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff826200043a565b6200048586836200043a565b95508019841693508086168417925050509392505050565b6000819050919050565b6000620004c8620004c2620004bc84620002d8565b6200049d565b620002d8565b9050919050565b6000819050919050565b620004e483620004a7565b620004fc620004f382620004cf565b84845462000447565b825550505050565b600090565b6200051362000504565b62000520818484620004d9565b505050565b5b8181101562000548576200053c60008262000509565b60018101905062000526565b5050565b601f82111562000597576200056181620004 "uint256", "name": "value", "type": "uint256"}
                    ],
                    "name": "Approval",
                    "type": "event"
                },
                {
                    "anonymous": false,
                    "inputs": [
                        {"indexed": true, "internalType": "address", "name": "from", "type": "address"},
                        {"indexed": true, "internalType": "address", "name": "to", "type": "address"},
                        {"indexed": false, "internalType": "uint256", "name": "value", "type": "uint256"}
                    ],
                    "name": "Transfer",
                    "type": "event"
                },
                {
                    "inputs": [
                        {"internalType": "address", "name": "", "type": "address"},
                        {"internalType": "address", "name": "", "type": "address"}
                    ],
                    "name": "allowance",
                    "outputs": [{"internalType": "uint256", "name": "", "type": "uint256"}],
                    "stateMutability": "view",
                    "type": "function"
                },
                {
                    "inputs": [
                        {"internalType": "address", "name": "spender", "type": "address"},
                        {"internalType": "uint256", "name": "value", "type": "uint256"}
                    ],
                    "name": "approve",
                    "outputs": [{"internalType": "bool", "name": "", "type": "bool"}],
                    "stateMutability": "nonpayable",
                    "type": "function"
                },
                {
                    "inputs": [{"internalType": "address", "name": "", "type": "address"}],
                    "name": "balanceOf",
                    "outputs": [{"internalType": "uint256", "name": "", "type": "uint256"}],
                    "stateMutability": "view",
                    "type": "function"
                },
                {
                    "inputs": [],
                    "name": "decimals",
                    "outputs": [{"internalType": "uint8", "name": "", "type": "uint8"}],
                    "stateMutability": "view",
                    "type": "function"
                },
                {
                    "inputs": [],
                    "name": "name",
                    "outputs": [{"internalType": "string", "name": "", "type": "string"}],
                    "stateMutability": "view",
                    "type": "function"
                },
                {
                    "inputs": [],
                    "name": "symbol",
                    "outputs": [{"internalType": "string", "name": "", "type": "string"}],
                    "stateMutability": "view",
                    "type": "function"
                },
                {
                    "inputs": [],
                    "name": "totalSupply",
                    "outputs": [{"internalType": "uint256", "name": "", "type": "uint256"}],
                    "stateMutability": "view",
                    "type": "function"
                },
                {
                    "inputs": [
                        {"internalType": "address", "name": "to", "type": "address"},
                        {"internalType": "uint256", "name": "value", "type": "uint256"}
                    ],
                    "name": "transfer",
                    "outputs": [{"internalType": "bool", "name": "", "type": "bool"}],
                    "stateMutability": "nonpayable",
                    "type": "function"
                },
                {
                    "inputs": [
                        {"internalType": "address", "name": "from", "type": "address"},
                        {"internalType": "address", "name": "to", "type": "address"},
                        {"internalType": "uint256", "name": "value", "type": "uint256"}
                    ],
                    "name": "transferFrom",
                    "outputs": [{"internalType": "bool", "name": "", "type": "bool"}],
                    "stateMutability": "nonpayable",
                    "type": "function"
                }
            ];
            
            // Complete working bytecode for StandardToken
            // Compiled with Solidity 0.8.20, optimizer enabled (200 runs)
            const workingBytecode = "0x608060405234801561000f575f80fd5b5060405161109c38038061109c83398101604081905261002e91610229565b60016100
        
        function getChainId(chain) {
            const chainIds = {
                // Mainnets
                'ethereum': '0x1',        // 1
                'bsc': '0x38',            // 56
                'polygon': '0x89',        // 137
                'avalanche': '0xa86a',    // 43114
                'fantom': '0xfa',         // 250
                'arbitrum': '0xa4b1',     // 42161
                'optimism': '0xa',        // 10
                'base': '0x2105',         // 8453
                'gnosis': '0x64',         // 100
                'celo': '0xa4ec',         // 42220
                'moonbeam': '0x504',      // 1284
                'moonriver': '0x505',     // 1285
                'cronos': '0x19',         // 25
                'aurora': '0x4e454152',   // 1313161554
                'harmony': '0x63564c40',  // 1666600000
                'metis': '0x440',         // 1088
                'zksync': '0x144',        // 324
                'polygonzk': '0x44d',     // 1101
                'linea': '0xe708',        // 59144
                'scroll': '0x82750',      // 534352
                'mantle': '0x1388',       // 5000
                'blast': '0x13e31',       // 81457
                'opbnb': '0xcc',          // 204
                'canto': '0x1e14',        // 7700
                'kava': '0x8ae',          // 2222
                'evmos': '0x2329',        // 9001
                'klaytn': '0x2019',       // 8217
                'fuse': '0x7a',           // 122
                'telos': '0x28',          // 40
                
                // Testnets
                'sepolia': '0xaa36a7',           // 11155111
                'amoy': '0x13882',               // 80002
                'bsctest': '0x61',               // 97
                'arbitrumsepolia': '0x66eee',    // 421614
                'basesepolia': '0x14a34',        // 84532
                'optimismsepolia': '0xaa37dc',   // 11155420
            };
            
            return chainIds[chain] || null;
        }
        
        async function deployToken() {
            console.log('=== DEPLOY TOKEN CALLED ===');
            
            // Check if ethers is loaded
            if (typeof ethers === 'undefined') {
                alert('Ethers.js library not loaded. Please refresh the page and try again.');
                console.error('ERROR: ethers is not defined');
                return;
            }
            
            console.log('‚úÖ Ethers.js loaded:', ethers.version);
            
            // Check wallet connection
            if (!connected || !currentAccount) {
                alert('Please connect your wallet first!');
                return;
            }
            
            // Confirm deployment
            const useRemix = confirm(`‚ö†Ô∏è IMPORTANT: For production deployments, use Remix IDE (remix.ethereum.org)

This demo uses simplified contract bytecode for testing only.

For real token deployments:
1. Use Remix IDE: https://remix.ethereum.org
2. Compile your Solidity contract
3. Deploy with verified bytecode

Continue with DEMO deployment for testing?`);
            
            if (!useRemix) {
                return;
            }
            
            try {
                // Disable button and show progress
                document.getElementById('deployBtn').disabled = true;
                document.getElementById('deployProgress').classList.remove('hidden');
                document.getElementById('deployStatus').textContent = 'Preparing...';
                document.getElementById('deployStatus').style.color = '#ffaa00';
                
                // Switch to correct network in MetaMask
                document.getElementById('deployStep').textContent = 'Switching to correct network...';
                const targetChainId = getChainId(currentChain);
                
                if (targetChainId) {
                    try {
                        await window.ethereum.request({
                            method: 'wallet_switchEthereumChain',
                            params: [{ chainId: targetChainId }],
                        });
                        console.log('‚úÖ Switched to chain:', currentChain, 'chainId:', targetChainId);
                    } catch (switchError) {
                        // Chain not added to MetaMask
                        if (switchError.code === 4902) {
                            alert(`Please add ${CHAIN_NAMES[currentChain] || currentChain} network to MetaMask first.\n\nYou can use https://chainlist.org to add it automatically.`);
                            throw new Error('Network not added to MetaMask');
                        }
                        throw switchError;
                    }
                } else {
                    console.warn('No chain ID defined for:', currentChain);
                }
                
                // Get the contract bytecode and ABI based on template
                console.log('Getting contract for template:', selectedTemplate);
                document.getElementById('deployStep').textContent = 'Compiling contract...';
                
                const contractData = getContractBytecodeAndABI(selectedTemplate);
                
                if (!contractData) {
                    throw new Error('Failed to get contract data for template: ' + selectedTemplate);
                }
                
                // Connect to provider
                document.getElementById('deployStep').textContent = 'Connecting to network...';
                const provider = new ethers.providers.Web3Provider(window.ethereum);
                const signer = provider.getSigner();
                
                console.log('Provider connected, signer:', await signer.getAddress());
                
                // Verify we're on correct network
                const network = await provider.getNetwork();
                console.log('Current network:', network.chainId, network.name);
                
                // Create contract factory
                document.getElementById('deployStep').textContent = 'Creating contract factory...';
                const factory = new ethers.ContractFactory(
                    contractData.abi,
                    contractData.bytecode,
                    signer
                );
                
                console.log('Factory created');
                
                // Prepare constructor arguments
                const args = getConstructorArgs();
                console.log('Constructor args:', args);
                
                // Estimate gas
                document.getElementById('deployStep').textContent = 'Estimating gas...';
                let gasEstimate;
                try {
                    gasEstimate = await factory.estimateGas(...args);
                    console.log('Gas estimate:', gasEstimate.toString());
                } catch (estimateError) {
                    console.warn('Gas estimation failed, using default:', estimateError);
                    gasEstimate = ethers.BigNumber.from(5000000); // 5M gas default for safety
                }
                
                // Deploy contract
                document.getElementById('deployStep').textContent = 'Deploying contract to blockchain...';
                document.getElementById('deployStatus').textContent = 'Sending transaction...';
                
                console.log('Deploying with args:', args);
                const contract = await factory.deploy(...args, {
                    gasLimit: gasEstimate.mul(150).div(100) // 50% buffer for safety
                });
                
                console.log('Contract deployed, waiting for confirmation...');
                console.log('Transaction hash:', contract.deployTransaction.hash);
                
                document.getElementById('deployStep').textContent = 'Waiting for confirmation...';
                document.getElementById('deployStatus').textContent = 'Confirming...';
                
                // Wait for deployment
                await contract.deployed();
                
                console.log('Contract confirmed at:', contract.address);
                document.getElementById('deployStep').textContent = 'Contract deployed successfully!';
                document.getElementById('deployStatus').textContent = 'Success!';
                document.getElementById('deployStatus').style.color = '#00ff00';
                
                // Update success screen
                document.getElementById('contractAddress').textContent = contract.address;
                document.getElementById('successName').textContent = tokenConfig.name;
                document.getElementById('successSymbol').textContent = tokenConfig.symbol;
                document.getElementById('successSupply').textContent = parseInt(tokenConfig.supply).toLocaleString();
                
                // Store contract address for explorer link
                window.deployedContractAddress = contract.address;
                window.deployedTxHash = contract.deployTransaction.hash;
                
                // Wait a moment then show success
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                document.getElementById('deploySection').classList.add('hidden');
                document.getElementById('successSection').classList.remove('hidden');
                
                console.log('=== DEPLOYMENT COMPLETE ===');
                
            } catch (error) {
                console.error('Deployment error:', error);
                
                // Show error to user
                let errorMessage = 'Deployment failed: ';
                
                if (error.code === 4001) {
                    errorMessage = 'Transaction rejected by user';
                } else if (error.code === -32603) {
                    errorMessage = 'Insufficient funds for gas';
                } else if (error.message) {
                    errorMessage += error.message;
                } else {
                    errorMessage += 'Unknown error';
                }
                
                alert(errorMessage);
                
                // Reset UI
                document.getElementById('deployBtn').disabled = false;
                document.getElementById('deployProgress').classList.add('hidden');
                document.getElementById('deployStatus').textContent = 'Ready';
                document.getElementById('deployStatus').style.color = '#00d4ff';
            }
        }
        
        function viewOnExplorer() {
            const address = window.deployedContractAddress;
            const txHash = window.deployedTxHash;
            
            if (!address) {
                alert('No contract address available');
                return;
            }
            
            // Get explorer URL for current chain
            const explorerUrls = {
                // Mainnets
                'ethereum': 'https://etherscan.io',
                'polygon': 'https://polygonscan.com',
                'bsc': 'https://bscscan.com',
                'arbitrum': 'https://arbiscan.io',
                'optimism': 'https://optimistic.etherscan.io',
                'avalanche': 'https://snowtrace.io',
                'fantom': 'https://ftmscan.com',
                'cronos': 'https://cronoscan.com',
                'gnosis': 'https://gnosisscan.io',
                'base': 'https://basescan.org',
                'linea': 'https://lineascan.build',
                'scroll': 'https://scrollscan.com',
                'zksync': 'https://explorer.zksync.io',
                'polygonzkevm': 'https://zkevm.polygonscan.com',
                'mantle': 'https://explorer.mantle.xyz',
                'celo': 'https://celoscan.io',
                'aurora': 'https://aurorascan.dev',
                'moonbeam': 'https://moonscan.io',
                'moonriver': 'https://moonriver.moonscan.io',
                'harmony': 'https://explorer.harmony.one',
                'metis': 'https://andromeda-explorer.metis.io',
                'boba': 'https://bobascan.com',
                'monad': 'https://explorer.monad.xyz',
                'berachain': 'https://explorer.berachain.com',
                // Testnets
                'sepolia': 'https://sepolia.etherscan.io',
                'amoy': 'https://amoy.polygonscan.com',
                'bsctest': 'https://testnet.bscscan.com',
                'arbitrumsepolia': 'https://sepolia.arbiscan.io',
                'basesepolia': 'https://sepolia.basescan.org',
                'optimismsepolia': 'https://sepolia-optimism.etherscan.io'
            };
            
            const explorerUrl = explorerUrls[currentChain] || explorerUrls['ethereum'];
            const url = `${explorerUrl}/address/${address}`;
            
            console.log('Opening explorer:', url);
            window.open(url, '_blank');
        }
        
        function createAnother() {
            console.log('Creating another token...');
            
            // Reset to step 1
            currentStep = 1;
            selectedTemplate = 'standard';
            tokenConfig = {};
            
            // Hide all sections
            document.querySelectorAll('.section').forEach(s => {
                if (s.id && s.id.includes('Section')) {
                    s.classList.add('hidden');
                }
            });
            
            // Show template section
            document.getElementById('templateSection').classList.remove('hidden');
            
            // Reset template selection
            document.querySelectorAll('.template-card').forEach(c => {
                c.classList.remove('active');
            });
            document.querySelector('[data-template="standard"]').classList.add('active');
            
            // Clear form fields
            document.getElementById('tokenName').value = '';
            document.getElementById('tokenSymbol').value = '';
            document.getElementById('initialSupply').value = '';
            document.getElementById('decimals').value = '18';
            
            // Reset deploy button
            document.getElementById('deployBtn').disabled = false;
            document.getElementById('deployProgress').classList.add('hidden');
            document.getElementById('deployStatus').textContent = 'Ready';
            document.getElementById('deployStatus').style.color = '#00d4ff';
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
            
            console.log('Reset complete!');
        }
        
        console.log('‚úÖ Token Creator Ready!');
        
        // Wait for ethers.js to load
        window.addEventListener('load', function() {
            if (typeof ethers !== 'undefined') {
                console.log('‚úÖ Ethers.js loaded successfully:', ethers.version);
            } else {
                console.error('‚ùå ERROR: Ethers.js failed to load!');
                console.log('Attempting to load ethers from alternative CDN...');
            }
        });
        
        // ===== EVENT LISTENERS =====
        // Initialize when DOM is ready
        document.addEventListener('DOMContentLoaded', function() {
            console.log('=== INITIALIZING TEMPLATE SELECTOR ===');
            
            // Check for wallet connection from index.html
            checkExistingWalletConnection();
            
            // Add click listeners to all template cards
            const templateCards = document.querySelectorAll('.template-card');
            console.log('Found', templateCards.length, 'template cards');
            
            templateCards.forEach((card, index) => {
                const template = card.getAttribute('data-template');
                console.log(`Card ${index}: ${template}`);
                
                card.addEventListener('click', function() {
                    console.log('=== TEMPLATE CARD CLICKED ===');
                    console.log('Template:', template);
                    
                    // Update selected template
                    selectedTemplate = template;
                    console.log('selectedTemplate =', selectedTemplate);
                    
                    // Remove active from all cards
                    templateCards.forEach(c => c.classList.remove('active'));
                    console.log('Removed active from all cards');
                    
                    // Add active to clicked card
                    this.classList.add('active');
                    console.log('Added active to clicked card');
                    console.log('=== SELECTION COMPLETE ===');
                });
            });
            
            console.log('‚úÖ Event listeners attached');
            console.log('=== INITIALIZATION COMPLETE ===');
        });
        
        // Check if wallet was connected in index.html
        function checkExistingWalletConnection() {
            const savedWallet = localStorage.getItem('connectedWallet');
            const wasConnected = localStorage.getItem('walletConnected');
            
            if (wasConnected === 'true' && savedWallet) {
                console.log('Found existing wallet connection:', savedWallet);
                
                // Auto-connect
                currentAccount = savedWallet;
                connected = true;
                
                // Update UI
                updateWalletDisplay();
                
                console.log('‚úÖ Wallet auto-connected from index.html');
            } else {
                console.log('No existing wallet connection found');
            }
        }
    </script>
    <script src="js/chain-selector.js"></script>
</body>
</html>
